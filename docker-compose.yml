version: "3.7"

services:
  frontend:
    build: frontend
    ports:
      - "3001:3001"
  broker:
    build:
      context: broker
      args:
        - TLS_SERVER_KEY=${FLOTILLA_BROKER_SERVER_KEY}
    ports:
      - "1883:1883"
  backend:
    build: backend
    ports:
      - "8000:8000"
    environment:
      # Overwrites the ip address for the Mqtt service to connect to the Mqtt container:
      - Mqtt__Host=broker
      - ASPNETCORE_ENVIRONMENT=Development
      - AZURE_CLIENT_SECRET=${FLOTILLA_CLIENT_SECRET}
      